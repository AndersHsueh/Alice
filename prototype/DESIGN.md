# ALICE Web UI 设计文档

## 设计概述

本 Web UI 原型基于 **ui-ux-designer** 技能的设计原则，为 ALICE CLI 项目创建一个现代化、用户友好的 Web 界面。

## 设计目标

1. **简洁现代**：采用深色主题，减少视觉疲劳
2. **实时反馈**：流式输出、工具调用状态清晰可见
3. **响应式设计**：支持桌面和移动端
4. **信息层级清晰**：用户消息和 AI 回复有明显区分

## UI/UX 设计原则

### 1. 视觉层次

- **主色**：`#00D9FF` (alice-blue) - 用于强调和链接
- **辅色**：`#B030FF` (alice-purple) - 用于渐变和装饰
- **背景**：深灰色 (`gray-900`) - 主背景
- **卡片**：中灰色 (`gray-800`) - 内容容器
- **边框**：`gray-700` - 分隔线

### 2. 布局结构

```
┌─────────────────────────────────────────┐
│           Header (固定)                 │
│  [ALICE] [状态] [模型信息]              │
├──────────┬──────────────────────────────┤
│          │                              │
│ Sidebar  │      ChatArea                │
│ (可折叠) │      (滚动区域)              │
│          │                              │
│ - 模型   │                              │
│ - 会话   │                              │
│          │                              │
├──────────┴──────────────────────────────┤
│           InputBox (固定)                │
│  [输入框] [发送按钮]                     │
└─────────────────────────────────────────┘
```

### 3. 组件设计

#### Header（顶部栏）
- **功能**：显示应用名称、连接状态、当前模型
- **设计**：深色背景，渐变文字效果
- **状态指示**：彩色圆点 + 文字说明

#### Sidebar（侧边栏）
- **功能**：模型选择、会话管理
- **响应式**：桌面端固定显示，移动端可折叠
- **交互**：点击遮罩层关闭（移动端）

#### ChatArea（聊天区域）
- **功能**：显示对话历史、流式输出、工具调用状态
- **滚动**：自动滚动到底部
- **空状态**：友好的欢迎界面

#### MessageBubble（消息气泡）
- **用户消息**：右对齐，蓝色背景
- **AI 回复**：左对齐，灰色背景，支持 Markdown
- **工具消息**：左对齐，紫色边框，显示工具名称和结果

#### ToolCallIndicator（工具调用指示器）
- **状态**：pending（⏳）、success（✅）、error（❌）
- **信息**：工具名称、执行结果/错误信息

#### InputBox（输入框）
- **功能**：多行输入，支持 Enter 发送
- **状态**：禁用状态（连接中/处理中）
- **提示**：快捷键说明

## 交互设计

### 1. 消息发送流程

```
用户输入 → 点击发送/Enter
  ↓
显示用户消息（立即）
  ↓
显示"处理中"状态
  ↓
流式接收 AI 回复（逐字显示）
  ↓
显示工具调用状态（如有）
  ↓
完成，更新消息列表
```

### 2. 工具调用显示

- **pending**：显示工具名称 + "处理中..."
- **success**：显示工具名称 + 执行结果（JSON 格式化）
- **error**：显示工具名称 + 错误信息（红色）

### 3. 会话管理

- **创建会话**：点击"新建"按钮
- **切换会话**：点击会话卡片
- **会话标识**：显示会话 ID 前 8 位 + 更新时间

## 响应式设计

### 桌面端（≥ 1024px）
- 侧边栏固定显示（宽度 320px）
- 聊天区域自适应宽度
- 所有功能完整显示

### 移动端（< 1024px）
- 侧边栏默认隐藏，通过菜单按钮打开
- 侧边栏打开时显示遮罩层
- 点击遮罩层或关闭按钮关闭侧边栏
- 菜单按钮固定在左上角

## 技术实现

### 1. 流式输出处理

使用 `fetch` API 的 `ReadableStream` 处理 NDJSON 流：

```typescript
for await (const event of api.chatStream({ message })) {
  if (event.type === 'text') {
    // 累积文本并更新 UI
  } else if (event.type === 'tool_call') {
    // 更新工具调用状态
  } else if (event.type === 'done') {
    // 完成，更新消息列表
  }
}
```

### 2. Markdown 渲染

使用 `marked` 库将 Markdown 转换为 HTML，并应用 Tailwind 的 `prose` 样式。

### 3. 状态管理

使用 React Hooks (`useState`, `useEffect`, `useCallback`) 管理组件状态。

## 可访问性

- **键盘导航**：支持 Tab 键切换焦点
- **ARIA 标签**：为交互元素添加适当的 ARIA 属性
- **颜色对比**：确保文字和背景有足够的对比度
- **焦点指示**：清晰的焦点样式

## 性能优化

1. **虚拟滚动**：如果消息数量很大，考虑使用虚拟滚动
2. **消息分页**：按需加载历史消息
3. **防抖处理**：输入框防抖（如需要）
4. **代码分割**：按路由分割代码（如需要）

## 未来改进

- [ ] 添加消息搜索功能
- [ ] 支持导出对话（HTML/Markdown）
- [ ] 主题切换（亮色/暗色）
- [ ] 快捷键支持（Cmd+K 等）
- [ ] 消息编辑和删除
- [ ] 语音输入支持
- [ ] 文件上传支持
- [ ] 代码高亮优化
- [ ] 表格渲染优化
- [ ] 图片显示支持

## 设计参考

- **GitHub Copilot Chat**：简洁的聊天界面
- **ChatGPT Web**：流式输出体验
- **Linear**：现代化的深色主题设计
- **Vercel**：渐变色彩运用

---

*本设计文档基于 ui-ux-designer 技能的设计原则创建*
