# ALICE - åŠå…¬æ™ºèƒ½åŠ©æ‰‹äº§å“è®¾è®¡

> [!info] äº§å“å®šä½
> **é¢å‘éæŠ€æœ¯äººå‘˜çš„ AI CLI å·¥å…·**  
> ä¸“æ³¨äºæ–‡æ¡£å¤„ç†ã€çŸ¥è¯†ç®¡ç†ã€åŠå…¬è‡ªåŠ¨åŒ–
> 
> "è®©æ¯ä¸ªåŠå…¬å®¤èŒå‘˜éƒ½æ‹¥æœ‰è‡ªå·±çš„ AI åŠ©æ‰‹"

## ğŸ¯ æ ¸å¿ƒç†å¿µ

### ä¸ºä»€ä¹ˆå…ˆåšç•Œé¢ï¼Ÿ

> [!success] è®¾è®¡æ€è·¯è®¤åŒ
> - âœ… ç•Œé¢é©±åŠ¨è®¾è®¡ï¼šé€šè¿‡å¯è§†åŒ–äº¤äº’ç†è§£ç”¨æˆ·éœ€æ±‚
> - âœ… å¿«é€Ÿè¿­ä»£ï¼šè¾¹çœ‹æ•ˆæœè¾¹è°ƒæ•´åŠŸèƒ½
> - âœ… ç”¨æˆ·è§†è§’ï¼šä»ä½¿ç”¨åœºæ™¯å€’æ¨æŠ€æœ¯å®ç°
> - âœ… é™ä½é—¨æ§›ï¼šCLI ä½†è¦åƒèŠå¤©ä¸€æ ·è‡ªç„¶

### ä¸ä»£ç å·¥å…·çš„å·®å¼‚

| ç»´åº¦ | ä»£ç å·¥å…· (Copilot) | åŠå…¬åŠ©æ‰‹ (ALICE) |
|------|---------------------|------------------|
| **ç›®æ ‡ç”¨æˆ·** | ç¨‹åºå‘˜ | åŠå…¬èŒå‘˜ã€çŸ¥è¯†å·¥ä½œè€… |
| **æ ¸å¿ƒåœºæ™¯** | å†™ä»£ç ã€Debug | æ•´ç†ç¬”è®°ã€å¤„ç†æ–‡æ¡£ |
| **è¾“å…¥å¯¹è±¡** | ä»£ç æ–‡ä»¶ | Word/Excel/PDF/Markdown |
| **è¾“å‡ºç»“æœ** | ä»£ç å˜æ›´ | æ–‡æ¡£ç”Ÿæˆã€æ•°æ®åˆ†æ |
| **äº¤äº’é£æ ¼** | æŠ€æœ¯æŒ‡ä»¤ | è‡ªç„¶è¯­è¨€å¯¹è¯ |
| **æˆåŠŸæ ‡å‡†** | ä»£ç èƒ½è¿è¡Œ | å†…å®¹æœ‰ä»·å€¼ã€çœæ—¶é—´ |

---

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½è®¾è®¡

### åŠŸèƒ½åˆ†ç±»

```mermaid
graph TD
    A[ALICE åŠå…¬åŠ©æ‰‹] --> B[çŸ¥è¯†ç®¡ç†]
    A --> C[æ–‡æ¡£å¤„ç†]
    A --> D[æ•°æ®åˆ†æ]
    A --> E[åŠå…¬è‡ªåŠ¨åŒ–]
    
    B --> B1[Obsidian ç¬”è®°æ•´ç†]
    B --> B2[çŸ¥è¯†å›¾è°±ç”Ÿæˆ]
    B --> B3[ç¬”è®°æœç´¢ä¸æ€»ç»“]
    
    C --> C1[Word æ–‡æ¡£åˆ†æ]
    C --> C2[PDF å†…å®¹æå–]
    C --> C3[æ ¼å¼è½¬æ¢]
    
    D --> D1[Excel æ•°æ®åˆ†æ]
    D --> D2[å›¾è¡¨ç”Ÿæˆ]
    D --> D3[æŠ¥è¡¨åˆ¶ä½œ]
    
    E --> E1[é‚®ä»¶è‰ç¨¿]
    E --> E2[ä¼šè®®çºªè¦]
    E --> E3[æ¨¡æ¿ç”Ÿæˆ]
```

---

## ğŸ¨ ç•Œé¢è®¾è®¡ä¼˜å…ˆ

### Phase 1: æœ€å°ç•Œé¢åŸå‹ (æœ¬å‘¨å®Œæˆ)

**ç›®æ ‡ï¼š** èƒ½è·‘èµ·æ¥ï¼Œèƒ½å¯¹è¯ï¼Œèƒ½çœ‹åˆ°æ•ˆæœ

#### æ ¸å¿ƒç•Œé¢å…ƒç´ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– ALICE - Your Office AI Assistant                       â”‚
â”‚  Workspace: ~/Documents/Projects                            â”‚
â”‚  Mode: Chat | Obsidian: Connected | Model: GPT-4          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  > You: å¸®æˆ‘æ•´ç†ä¸€ä¸‹è¿™ä¸ªæœˆçš„ä¼šè®®çºªè¦                         â”‚
â”‚                                                              â”‚
â”‚  ğŸ¤– Alice: å¥½çš„ï¼æˆ‘æ‰¾åˆ°äº† 5 ä»½ä¼šè®®çºªè¦æ–‡ä»¶ï¼š                 â”‚
â”‚                                                              â”‚
â”‚  ğŸ“„ 2026-02-03-äº§å“è¯„å®¡ä¼š.md                                 â”‚
â”‚  ğŸ“„ 2026-02-10-å‘¨ä¾‹ä¼š.md                                     â”‚
â”‚  ğŸ“„ 2026-02-15-å®¢æˆ·éœ€æ±‚è®¨è®º.md                               â”‚
â”‚  ğŸ“„ 2026-02-20-æŠ€æœ¯æ–¹æ¡ˆè¯„å®¡.md                               â”‚
â”‚  ğŸ“„ 2026-02-25-å­£åº¦è§„åˆ’ä¼š.md                                 â”‚
â”‚                                                              â”‚
â”‚  æˆ‘å¯ä»¥å¸®ä½ ï¼š                                                 â”‚
â”‚  1. ç”Ÿæˆæœˆåº¦ä¼šè®®æ€»ç»“æŠ¥å‘Š                                     â”‚
â”‚  2. æå–æ‰€æœ‰å¾…åŠäº‹é¡¹                                         â”‚
â”‚  3. åˆ†æè®¨è®ºçš„å…³é”®ä¸»é¢˜                                       â”‚
â”‚                                                              â”‚
â”‚  ä½ æƒ³åšå“ªä¸€ä¸ªï¼Ÿ                                              â”‚
â”‚                                                              â”‚
â”‚  > You: â–ˆ                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Ctrl+C] Quit  [/help] Commands  [Tab] Suggestions  [â†‘â†“] History
```

#### äº¤äº’æµç¨‹è®¾è®¡

```typescript
// ç”¨æˆ·è¾“å…¥ç¤ºä¾‹
ç”¨æˆ·: "åˆ†æä¸€ä¸‹æœ¬æœˆçš„é”€å”®æ•°æ®"

// ALICE å¤„ç†æµç¨‹
1. ğŸ” ç†è§£æ„å›¾: æ•°æ®åˆ†æä»»åŠ¡
2. ğŸ“‚ æ‰«ææ–‡ä»¶: æ‰¾åˆ° sales-2026-02.xlsx
3. ğŸ“Š è¯»å–æ•°æ®: è§£æ Excel å†…å®¹
4. ğŸ¤” AI åˆ†æ: ç”Ÿæˆæ´å¯ŸæŠ¥å‘Š
5. ğŸ’¬ å›å¤ç”¨æˆ·: å±•ç¤ºç»“æœ + å¯é€‰æ“ä½œ

// å±•ç¤ºç»“æœ
Alice:
  ğŸ“Š äºŒæœˆé”€å”®æ•°æ®åˆ†æ
  
  æ€»é”€å”®é¢: Â¥1,234,567 (ç¯æ¯” +15.3%)
  è®¢å•æ•°é‡: 456 å•
  å¹³å‡å®¢å•ä»·: Â¥2,706
  
  ğŸ“ˆ è¶‹åŠ¿åˆ†æ:
  â€¢ å‘¨ä¸€è‡³å‘¨ä¸‰é”€é‡æœ€é«˜
  â€¢ äº§å“ A å æ¯” 45%ï¼Œæ˜¯ä¸»åŠ›
  â€¢ åä¸œåŒºè´¡çŒ®äº† 60% è¥æ”¶
  
  ğŸ¯ å»ºè®®:
  â€¢ åŠ å¤§å‘¨æœ«è¥é”€åŠ›åº¦
  â€¢ å…³æ³¨äº§å“ B çš„å¢é•¿æ½œåŠ›
  
  æˆ‘å¯ä»¥ï¼š
  1. ç”Ÿæˆè¯¦ç»† Word æŠ¥å‘Š
  2. åˆ›å»ºå¯è§†åŒ–å›¾è¡¨
  3. å¯¹æ¯”ä¸Šæœˆæ•°æ®
  
  éœ€è¦æˆ‘åšä»€ä¹ˆï¼Ÿ
```

---

## ğŸ› ï¸ ç•Œé¢å®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: Ink + React (æ¨èå¿«é€ŸåŸå‹)

**ä¸ºä»€ä¹ˆé€‰æ‹© Inkï¼Ÿ**
- âœ… ç»„ä»¶åŒ–å¼€å‘ï¼Œåƒå†™ç½‘é¡µä¸€æ ·
- âœ… çƒ­æ›´æ–°ï¼Œå®æ—¶çœ‹æ•ˆæœ
- âœ… ä¸°å¯Œçš„ç¤¾åŒºç»„ä»¶

```typescript
// src/App.tsx
import React, { useState } from 'react';
import { Box, Text } from 'ink';
import { Header } from './components/Header';
import { ChatArea } from './components/ChatArea';
import { InputBox } from './components/InputBox';
import { StatusBar } from './components/StatusBar';
import { QuickActions } from './components/QuickActions';

interface Message {
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
  metadata?: {
    files?: string[];
    actions?: string[];
  };
}

export default function App() {
  const [messages, setMessages] = useState<Message[]>([]);
  const [workspace, setWorkspace] = useState(process.cwd());
  const [obsidianPath, setObsidianPath] = useState('');
  const [isProcessing, setIsProcessing] = useState(false);
  
  const handleUserInput = async (input: string) => {
    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
    const userMsg: Message = {
      role: 'user',
      content: input,
      timestamp: new Date()
    };
    setMessages(prev => [...prev, userMsg]);
    
    setIsProcessing(true);
    
    // å¤„ç†å‘½ä»¤
    if (input.startsWith('/')) {
      await handleCommand(input);
    } else {
      await handleChat(input);
    }
    
    setIsProcessing(false);
  };
  
  const handleChat = async (input: string) => {
    // TODO: è°ƒç”¨ LLM + å·¥å…·
    const response = await processUserRequest(input, {
      workspace,
      obsidianPath,
      recentMessages: messages.slice(-5)
    });
    
    const assistantMsg: Message = {
      role: 'assistant',
      content: response.content,
      timestamp: new Date(),
      metadata: response.metadata
    };
    
    setMessages(prev => [...prev, assistantMsg]);
  };
  
  return (
    <Box flexDirection="column" height="100%">
      <Header 
        workspace={workspace}
        obsidianConnected={!!obsidianPath}
      />
      
      <ChatArea 
        messages={messages}
        isProcessing={isProcessing}
      />
      
      {messages.length > 0 && messages[messages.length - 1].metadata?.actions && (
        <QuickActions 
          actions={messages[messages.length - 1].metadata!.actions!}
          onSelect={handleUserInput}
        />
      )}
      
      <InputBox 
        onSubmit={handleUserInput}
        disabled={isProcessing}
      />
      
      <StatusBar />
    </Box>
  );
}
```

### æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 1. Header ç»„ä»¶

```typescript
// src/components/Header.tsx
import React from 'react';
import { Box, Text } from 'ink';
import chalk from 'chalk';

interface Props {
  workspace: string;
  obsidianConnected: boolean;
}

export const Header: React.FC<Props> = ({ workspace, obsidianConnected }) => {
  return (
    <Box 
      borderStyle="round" 
      borderColor="cyan"
      padding={1}
      marginBottom={1}
    >
      <Box flexDirection="column" width="100%">
        <Text bold color="cyan">
          ğŸ¤– ALICE - Your Office AI Assistant
        </Text>
        
        <Box marginTop={1}>
          <Text dimColor>Workspace: </Text>
          <Text color="yellow">{workspace}</Text>
        </Box>
        
        <Box>
          <Text dimColor>Obsidian: </Text>
          <Text color={obsidianConnected ? 'green' : 'gray'}>
            {obsidianConnected ? 'âœ“ Connected' : 'âœ— Not Connected'}
          </Text>
        </Box>
      </Box>
    </Box>
  );
};
```

#### 2. ChatArea ç»„ä»¶

```typescript
// src/components/ChatArea.tsx
import React, { useEffect, useRef } from 'react';
import { Box, Text } from 'ink';
import Markdown from 'ink-markdown';
import Spinner from 'ink-spinner';

interface Message {
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
  metadata?: any;
}

interface Props {
  messages: Message[];
  isProcessing: boolean;
}

export const ChatArea: React.FC<Props> = ({ messages, isProcessing }) => {
  return (
    <Box 
      flexDirection="column" 
      padding={1}
      flexGrow={1}
      overflow="hidden"
    >
      {messages.length === 0 ? (
        <WelcomeScreen />
      ) : (
        messages.map((msg, idx) => (
          <MessageBubble key={idx} message={msg} />
        ))
      )}
      
      {isProcessing && (
        <Box marginTop={1}>
          <Text color="cyan">
            <Spinner type="dots" />
          </Text>
          <Text dimColor> Alice is thinking...</Text>
        </Box>
      )}
    </Box>
  );
};

const WelcomeScreen: React.FC = () => (
  <Box flexDirection="column" alignItems="center" justifyContent="center">
    <Text bold color="cyan">
      ğŸ‘‹ Hello! I'm ALICE, your office AI assistant
    </Text>
    
    <Box marginTop={1} flexDirection="column">
      <Text dimColor>I can help you with:</Text>
      <Text>  ğŸ“ Organizing Obsidian notes</Text>
      <Text>  ğŸ“„ Analyzing Word/Excel documents</Text>
      <Text>  ğŸ“Š Creating reports and summaries</Text>
      <Text>  âœ‰ï¸ Drafting emails and memos</Text>
    </Box>
    
    <Box marginTop={2}>
      <Text dimColor>Type </Text>
      <Text color="yellow">/help</Text>
      <Text dimColor> to see available commands</Text>
    </Box>
  </Box>
);

const MessageBubble: React.FC<{ message: Message }> = ({ message }) => {
  const isUser = message.role === 'user';
  
  return (
    <Box 
      flexDirection="column" 
      marginBottom={1}
      paddingLeft={isUser ? 0 : 2}
    >
      <Box>
        <Text bold color={isUser ? 'cyan' : 'green'}>
          {isUser ? '> You' : 'ğŸ¤– Alice'}
        </Text>
        <Text dimColor> â€¢ {formatTime(message.timestamp)}</Text>
      </Box>
      
      <Box marginLeft={2} marginTop={0}>
        {isUser ? (
          <Text>{message.content}</Text>
        ) : (
          <Markdown>{message.content}</Markdown>
        )}
      </Box>
      
      {message.metadata?.files && (
        <Box marginLeft={2} marginTop={1}>
          <FileList files={message.metadata.files} />
        </Box>
      )}
    </Box>
  );
};

const FileList: React.FC<{ files: string[] }> = ({ files }) => (
  <Box flexDirection="column">
    {files.map((file, idx) => (
      <Text key={idx} dimColor>
        ğŸ“„ {file}
      </Text>
    ))}
  </Box>
);

function formatTime(date: Date): string {
  return date.toLocaleTimeString('zh-CN', { 
    hour: '2-digit', 
    minute: '2-digit' 
  });
}
```

#### 3. QuickActions ç»„ä»¶

```typescript
// src/components/QuickActions.tsx
import React, { useState } from 'react';
import { Box, Text, useInput } from 'ink';

interface Props {
  actions: string[];
  onSelect: (action: string) => void;
}

export const QuickActions: React.FC<Props> = ({ actions, onSelect }) => {
  const [selected, setSelected] = useState(0);
  
  useInput((input, key) => {
    if (key.upArrow) {
      setSelected(prev => Math.max(0, prev - 1));
    } else if (key.downArrow) {
      setSelected(prev => Math.min(actions.length - 1, prev + 1));
    } else if (key.return) {
      onSelect(actions[selected]);
    }
  });
  
  return (
    <Box 
      flexDirection="column" 
      borderStyle="round"
      borderColor="yellow"
      padding={1}
      marginBottom={1}
    >
      <Text bold color="yellow">ğŸ’¡ Quick Actions:</Text>
      
      {actions.map((action, idx) => (
        <Box key={idx} marginLeft={1}>
          <Text color={idx === selected ? 'cyan' : 'white'}>
            {idx === selected ? 'â–¶ ' : '  '}
            {idx + 1}. {action}
          </Text>
        </Box>
      ))}
      
      <Box marginTop={1}>
        <Text dimColor>Use â†‘â†“ arrows to select, Enter to confirm</Text>
      </Box>
    </Box>
  );
};
```

#### 4. InputBox ç»„ä»¶

```typescript
// src/components/InputBox.tsx
import React, { useState } from 'react';
import { Box, Text, useInput } from 'ink';
import TextInput from 'ink-text-input';

interface Props {
  onSubmit: (input: string) => void;
  disabled?: boolean;
}

export const InputBox: React.FC<Props> = ({ onSubmit, disabled = false }) => {
  const [value, setValue] = useState('');
  
  const handleSubmit = () => {
    if (value.trim() && !disabled) {
      onSubmit(value);
      setValue('');
    }
  };
  
  return (
    <Box 
      borderStyle="round" 
      borderColor={disabled ? 'gray' : 'cyan'}
      padding={1}
    >
      <Text color="yellow">{'> '}</Text>
      
      {disabled ? (
        <Text dimColor>Processing...</Text>
      ) : (
        <TextInput
          value={value}
          onChange={setValue}
          onSubmit={handleSubmit}
          placeholder="Type your message or /help for commands..."
        />
      )}
    </Box>
  );
};
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. Obsidian é›†æˆæ¨¡å—

```typescript
// src/modules/obsidian/index.ts
import fs from 'fs/promises';
import path from 'path';
import matter from 'gray-matter';

export class ObsidianManager {
  private vaultPath: string;
  
  constructor(vaultPath: string) {
    this.vaultPath = vaultPath;
  }
  
  // æœç´¢ç¬”è®°
  async searchNotes(query: string): Promise<Note[]> {
    const files = await this.getAllMarkdownFiles();
    const results: Note[] = [];
    
    for (const file of files) {
      const content = await fs.readFile(file, 'utf-8');
      const { data, content: body } = matter(content);
      
      if (body.toLowerCase().includes(query.toLowerCase())) {
        results.push({
          path: file,
          title: this.extractTitle(body),
          frontmatter: data,
          excerpt: this.getExcerpt(body, query)
        });
      }
    }
    
    return results;
  }
  
  // åˆ†æç¬”è®°ç»“æ„
  async analyzeVault(): Promise<VaultAnalysis> {
    const files = await this.getAllMarkdownFiles();
    const tags = new Set<string>();
    const links = new Map<string, string[]>();
    
    for (const file of files) {
      const content = await fs.readFile(file, 'utf-8');
      const { data } = matter(content);
      
      // æå–æ ‡ç­¾
      if (data.tags) {
        (Array.isArray(data.tags) ? data.tags : [data.tags])
          .forEach(tag => tags.add(tag));
      }
      
      // æå–é“¾æ¥
      const wikiLinks = content.match(/\[\[(.*?)\]\]/g) || [];
      links.set(file, wikiLinks.map(l => l.slice(2, -2)));
    }
    
    return {
      totalNotes: files.length,
      tags: Array.from(tags),
      linkGraph: Object.fromEntries(links),
      orphanNotes: this.findOrphanNotes(links)
    };
  }
  
  // æ•´ç†ç¬”è®°
  async organizeNotes(strategy: 'by-date' | 'by-tag' | 'by-folder'): Promise<OrganizeResult> {
    // å®ç°ä¸åŒçš„æ•´ç†ç­–ç•¥
    switch (strategy) {
      case 'by-date':
        return await this.organizeByDate();
      case 'by-tag':
        return await this.organizeByTag();
      case 'by-folder':
        return await this.organizeByFolder();
      default:
        throw new Error('Unknown strategy');
    }
  }
  
  // ç”Ÿæˆç›®å½•ç´¢å¼•
  async generateIndex(options: IndexOptions): Promise<string> {
    const files = await this.getAllMarkdownFiles();
    let index = '# ğŸ“š Vault Index\n\n';
    
    if (options.groupBy === 'folder') {
      const byFolder = this.groupByFolder(files);
      for (const [folder, items] of Object.entries(byFolder)) {
        index += `## ${folder}\n\n`;
        items.forEach(file => {
          const title = this.extractTitle(file);
          index += `- [[${title}]]\n`;
        });
        index += '\n';
      }
    }
    
    return index;
  }
  
  private async getAllMarkdownFiles(): Promise<string[]> {
    // é€’å½’è·å–æ‰€æœ‰ .md æ–‡ä»¶
    const files: string[] = [];
    
    async function walk(dir: string) {
      const entries = await fs.readdir(dir, { withFileTypes: true });
      
      for (const entry of entries) {
        const fullPath = path.join(dir, entry.name);
        
        if (entry.isDirectory() && !entry.name.startsWith('.')) {
          await walk(fullPath);
        } else if (entry.isFile() && entry.name.endsWith('.md')) {
          files.push(fullPath);
        }
      }
    }
    
    await walk(this.vaultPath);
    return files;
  }
  
  private extractTitle(content: string): string {
    const match = content.match(/^#\s+(.+)$/m);
    return match ? match[1] : 'Untitled';
  }
  
  private getExcerpt(content: string, query: string): string {
    const lines = content.split('\n');
    const matchLine = lines.find(l => 
      l.toLowerCase().includes(query.toLowerCase())
    );
    
    return matchLine ? matchLine.slice(0, 100) + '...' : '';
  }
  
  private findOrphanNotes(links: Map<string, string[]>): string[] {
    const allLinks = new Set<string>();
    links.forEach(targets => targets.forEach(t => allLinks.add(t)));
    
    const orphans: string[] = [];
    for (const [file] of links) {
      const basename = path.basename(file, '.md');
      if (!allLinks.has(basename) && links.get(file)?.length === 0) {
        orphans.push(file);
      }
    }
    
    return orphans;
  }
}

interface Note {
  path: string;
  title: string;
  frontmatter: any;
  excerpt: string;
}

interface VaultAnalysis {
  totalNotes: number;
  tags: string[];
  linkGraph: Record<string, string[]>;
  orphanNotes: string[];
}
```

### 2. æ–‡æ¡£å¤„ç†æ¨¡å—

```typescript
// src/modules/document/index.ts
import mammoth from 'mammoth';  // Word
import * as XLSX from 'xlsx';    // Excel
import pdf from 'pdf-parse';     // PDF

export class DocumentProcessor {
  // Word æ–‡æ¡£å¤„ç†
  async readWord(filePath: string): Promise<WordDocument> {
    const result = await mammoth.extractRawText({ path: filePath });
    const html = await mammoth.convertToHtml({ path: filePath });
    
    return {
      text: result.value,
      html: html.value,
      wordCount: result.value.split(/\s+/).length,
      metadata: await this.extractWordMetadata(filePath)
    };
  }
  
  // Excel æ•°æ®åˆ†æ
  async analyzeExcel(filePath: string): Promise<ExcelAnalysis> {
    const workbook = XLSX.readFile(filePath);
    const analysis: ExcelAnalysis = {
      sheets: [],
      summary: {}
    };
    
    for (const sheetName of workbook.SheetNames) {
      const sheet = workbook.Sheets[sheetName];
      const data = XLSX.utils.sheet_to_json(sheet);
      
      analysis.sheets.push({
        name: sheetName,
        rowCount: data.length,
        columns: this.getColumns(data),
        statistics: this.calculateStatistics(data)
      });
    }
    
    return analysis;
  }
  
  // PDF æ–‡æœ¬æå–
  async extractPDF(filePath: string): Promise<PDFContent> {
    const dataBuffer = await fs.readFile(filePath);
    const data = await pdf(dataBuffer);
    
    return {
      text: data.text,
      pages: data.numpages,
      metadata: data.info,
      outline: this.extractOutline(data.text)
    };
  }
  
  // æ–‡æ¡£å¯¹æ¯”
  async compareDocuments(file1: string, file2: string): Promise<DocumentDiff> {
    const doc1 = await this.readDocument(file1);
    const doc2 = await this.readDocument(file2);
    
    return {
      added: this.findAdded(doc1.text, doc2.text),
      removed: this.findRemoved(doc1.text, doc2.text),
      changed: this.findChanged(doc1.text, doc2.text),
      similarity: this.calculateSimilarity(doc1.text, doc2.text)
    };
  }
  
  // ç”Ÿæˆæ‘˜è¦
  async summarize(content: string, options: SummaryOptions): Promise<string> {
    // ä½¿ç”¨ LLM ç”Ÿæˆæ‘˜è¦
    const prompt = `
      è¯·å¯¹ä»¥ä¸‹å†…å®¹ç”Ÿæˆ${options.length || 'ç®€çŸ­'}çš„æ‘˜è¦ï¼š
      
      ${content}
      
      æ‘˜è¦è¦æ±‚ï¼š
      - æå–æ ¸å¿ƒè§‚ç‚¹
      - ä¿ç•™å…³é”®ä¿¡æ¯
      - ä½¿ç”¨${options.language || 'ä¸­æ–‡'}
    `;
    
    return await this.callLLM(prompt);
  }
  
  private getColumns(data: any[]): string[] {
    if (data.length === 0) return [];
    return Object.keys(data[0]);
  }
  
  private calculateStatistics(data: any[]): Record<string, any> {
    const stats: Record<string, any> = {};
    const columns = this.getColumns(data);
    
    for (const col of columns) {
      const values = data.map(row => row[col]).filter(v => typeof v === 'number');
      
      if (values.length > 0) {
        stats[col] = {
          min: Math.min(...values),
          max: Math.max(...values),
          avg: values.reduce((a, b) => a + b, 0) / values.length,
          sum: values.reduce((a, b) => a + b, 0)
        };
      }
    }
    
    return stats;
  }
}
```

### 3. AI å¯¹è¯å¼•æ“

```typescript
// src/modules/ai/engine.ts
import OpenAI from 'openai';

export class AIEngine {
  private client: OpenAI;
  private conversationHistory: Message[] = [];
  private tools: Tool[] = [];
  
  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey });
    this.registerTools();
  }
  
  async chat(userInput: string, context: Context): Promise<AIResponse> {
    // æ·»åŠ ç³»ç»Ÿæç¤º
    const systemPrompt = this.buildSystemPrompt(context);
    
    // æ„å»ºæ¶ˆæ¯
    const messages = [
      { role: 'system', content: systemPrompt },
      ...this.conversationHistory,
      { role: 'user', content: userInput }
    ];
    
    // è°ƒç”¨ LLM
    const response = await this.client.chat.completions.create({
      model: 'gpt-4',
      messages: messages as any,
      tools: this.tools.map(t => t.definition),
      stream: false
    });
    
    const choice = response.choices[0];
    
    // å¤„ç†å·¥å…·è°ƒç”¨
    if (choice.message.tool_calls) {
      return await this.handleToolCalls(choice.message.tool_calls, context);
    }
    
    // æ™®é€šå›å¤
    return {
      content: choice.message.content || '',
      actions: this.extractActions(choice.message.content || '')
    };
  }
  
  private buildSystemPrompt(context: Context): string {
    return `
ä½ æ˜¯ ALICEï¼Œä¸€ä¸ªä¸“ä¸šçš„åŠå…¬æ™ºèƒ½åŠ©æ‰‹ã€‚

å½“å‰ä¸Šä¸‹æ–‡ï¼š
- å·¥ä½œç›®å½•: ${context.workspace}
- Obsidian åº“: ${context.obsidianPath || 'æœªè¿æ¥'}
- æœ€è¿‘æ–‡ä»¶: ${context.recentFiles.join(', ')}

ä½ çš„èƒ½åŠ›ï¼š
1. æ•´ç†å’Œåˆ†æ Obsidian ç¬”è®°
2. å¤„ç† Wordã€Excelã€PDF æ–‡æ¡£
3. ç”ŸæˆæŠ¥å‘Šå’Œæ‘˜è¦
4. å›ç­”åŠå…¬ç›¸å…³é—®é¢˜

å›ç­”é£æ ¼ï¼š
- ä½¿ç”¨ä¸­æ–‡
- ç®€æ´ä¸“ä¸š
- æä¾›å¯æ“ä½œçš„å»ºè®®
- å¿…è¦æ—¶æä¾›å¤šä¸ªé€‰é¡¹ä¾›ç”¨æˆ·é€‰æ‹©

å½“ç”¨æˆ·è¯·æ±‚æ“ä½œæ—¶ï¼Œæä¾›æ¸…æ™°çš„ Quick Actions é€‰é¡¹ã€‚
    `.trim();
  }
  
  private registerTools() {
    // Obsidian å·¥å…·
    this.tools.push({
      name: 'search_obsidian_notes',
      definition: {
        type: 'function',
        function: {
          name: 'search_obsidian_notes',
          description: 'åœ¨ Obsidian åº“ä¸­æœç´¢ç¬”è®°',
          parameters: {
            type: 'object',
            properties: {
              query: { type: 'string', description: 'æœç´¢å…³é”®è¯' }
            },
            required: ['query']
          }
        }
      },
      handler: async (args: any, context: Context) => {
        const manager = new ObsidianManager(context.obsidianPath);
        return await manager.searchNotes(args.query);
      }
    });
    
    // Excel åˆ†æå·¥å…·
    this.tools.push({
      name: 'analyze_excel',
      definition: {
        type: 'function',
        function: {
          name: 'analyze_excel',
          description: 'åˆ†æ Excel æ–‡ä»¶æ•°æ®',
          parameters: {
            type: 'object',
            properties: {
              filePath: { type: 'string', description: 'æ–‡ä»¶è·¯å¾„' }
            },
            required: ['filePath']
          }
        }
      },
      handler: async (args: any, context: Context) => {
        const processor = new DocumentProcessor();
        return await processor.analyzeExcel(args.filePath);
      }
    });
    
    // æ›´å¤šå·¥å…·...
  }
  
  private async handleToolCalls(
    toolCalls: any[], 
    context: Context
  ): Promise<AIResponse> {
    const results = [];
    
    for (const call of toolCalls) {
      const tool = this.tools.find(t => t.name === call.function.name);
      if (tool) {
        const args = JSON.parse(call.function.arguments);
        const result = await tool.handler(args, context);
        results.push(result);
      }
    }
    
    // å°†å·¥å…·ç»“æœå‘é€å› LLM è·å–æœ€ç»ˆå“åº”
    return await this.synthesizeResponse(results, context);
  }
  
  private extractActions(content: string): string[] {
    // ä»å›å¤ä¸­æå–å¯æ‰§è¡Œçš„æ“ä½œ
    const actions: string[] = [];
    const lines = content.split('\n');
    
    for (const line of lines) {
      const match = line.match(/^\d+\.\s+(.+)$/);
      if (match) {
        actions.push(match[1]);
      }
    }
    
    return actions;
  }
}

interface Context {
  workspace: string;
  obsidianPath: string;
  recentFiles: string[];
}

interface AIResponse {
  content: string;
  actions?: string[];
  metadata?: {
    files?: string[];
    charts?: any[];
  };
}

interface Tool {
  name: string;
  definition: any;
  handler: (args: any, context: Context) => Promise<any>;
}
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨æŒ‡å—

### Step 1: åˆ›å»ºé¡¹ç›® (5åˆ†é’Ÿ)

```bash
mkdir alice-office-assistant
cd alice-office-assistant
npm init -y

# å®‰è£…ä¾èµ–
npm install ink react
npm install @types/react @types/node typescript tsx
npm install chalk gradient-string ora boxen
npm install figlet @types/figlet

# Obsidian æ”¯æŒ
npm install gray-matter glob

# æ–‡æ¡£å¤„ç†
npm install mammoth xlsx pdf-parse

# AI
npm install openai

# å¼€å‘å·¥å…·
npm install -D @types/figlet nodemon
```

### Step 2: é…ç½® TypeScript

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "jsx": "react",
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true
  }
}
```

### Step 3: åˆ›å»ºå…¥å£æ–‡ä»¶

```typescript
// src/index.tsx
#!/usr/bin/env node
import React from 'react';
import { render } from 'ink';
import App from './App.js';
import { showBanner } from './banner/index.js';

async function main() {
  // æ˜¾ç¤º banner
  await showBanner();
  
  // å¯åŠ¨åº”ç”¨
  render(<App />);
}

main().catch(console.error);
```

### Step 4: è¿è¡Œ

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­æ›´æ–°ï¼‰
npm run dev

# æˆ–ç›´æ¥è¿è¡Œ
tsx src/index.tsx
```

---

## ğŸ“ ç”¨æˆ·æ•…äº‹ç¤ºä¾‹

### æ•…äº‹ 1: æ•´ç†ä¼šè®®çºªè¦

```
ç”¨æˆ·: å¸®æˆ‘æ•´ç†è¿™ä¸ªæœˆçš„ä¼šè®®çºªè¦

Alice: 
  å¥½çš„ï¼æˆ‘åœ¨ ~/Documents/Meetings æ‰¾åˆ°äº† 5 ä»½ä¼šè®®çºªè¦ï¼š
  
  ğŸ“„ 2026-02-03-äº§å“è¯„å®¡ä¼š.md
  ğŸ“„ 2026-02-10-å‘¨ä¾‹ä¼š.md
  ğŸ“„ 2026-02-15-å®¢æˆ·éœ€æ±‚è®¨è®º.md
  ğŸ“„ 2026-02-20-æŠ€æœ¯æ–¹æ¡ˆè¯„å®¡.md
  ğŸ“„ 2026-02-25-å­£åº¦è§„åˆ’ä¼š.md
  
  ğŸ’¡ Quick Actions:
  1. ç”Ÿæˆæœˆåº¦ä¼šè®®æ€»ç»“æŠ¥å‘Š
  2. æå–æ‰€æœ‰å¾…åŠäº‹é¡¹ï¼ˆè·¨ä¼šè®®ï¼‰
  3. æŒ‰ä¸»é¢˜åˆ†ç±»è®¨è®ºå†…å®¹
  4. åˆ›å»º Obsidian MOCï¼ˆå†…å®¹åœ°å›¾ï¼‰

ç”¨æˆ·: é€‰æ‹© 1

Alice:
  æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...
  
  âœ“ å·²åˆ›å»º: 2026-02-ä¼šè®®æœˆæŠ¥.md
  
  ğŸ“Š æŠ¥å‘Šæ‘˜è¦:
  - å…± 5 æ¬¡ä¼šè®®ï¼Œ15 ä½å‚ä¸è€…
  - è®¨è®ºäº† 3 ä¸ªæ ¸å¿ƒé¡¹ç›®
  - äº§ç”Ÿ 23 ä¸ªå¾…åŠäº‹é¡¹ï¼ˆ12 ä¸ªå·²å®Œæˆï¼‰
  - é‡ç‚¹å†³ç­–ï¼šQ1 äº§å“è·¯çº¿å›¾ç¡®å®š
  
  æŠ¥å‘Šå·²ä¿å­˜åˆ°ï¼š~/Documents/Reports/
  
  éœ€è¦æˆ‘åšä»€ä¹ˆï¼Ÿ
```

### æ•…äº‹ 2: åˆ†æé”€å”®æ•°æ®

```
ç”¨æˆ·: åˆ†æä¸€ä¸‹è¿™ä¸ª Excel é‡Œçš„é”€å”®æ•°æ®

Alice:
  æ‰¾åˆ°æ–‡ä»¶ï¼šsales-2026-02.xlsx
  
  ğŸ“Š äºŒæœˆé”€å”®æ•°æ®åˆ†æ
  
  ğŸ“ˆ æ€»ä½“è¡¨ç°:
  â€¢ æ€»é”€å”®é¢: Â¥1,234,567 (ç¯æ¯” +15.3%)
  â€¢ è®¢å•æ•°é‡: 456 å•
  â€¢ å¹³å‡å®¢å•ä»·: Â¥2,706
  â€¢ å®¢æˆ·æ•°: 312 äººï¼ˆæ–°å®¢ 89 äººï¼‰
  
  ğŸ† Top äº§å“:
  1. äº§å“ A - Â¥556,789 (45%)
  2. äº§å“ B - Â¥345,678 (28%)
  3. äº§å“ C - Â¥234,567 (19%)
  
  ğŸ“ åŒºåŸŸåˆ†å¸ƒ:
  â€¢ åä¸œ: 60%
  â€¢ åå—: 25%
  â€¢ ååŒ—: 15%
  
  ğŸ’¡ Quick Actions:
  1. ç”Ÿæˆ Word ç‰ˆè¯¦ç»†æŠ¥å‘Š
  2. åˆ›å»ºå¯è§†åŒ–å›¾è¡¨ï¼ˆPNGï¼‰
  3. å¯¹æ¯”ä¸Šæœˆæ•°æ®
  4. å‘é€ç»™ç®¡ç†å±‚ï¼ˆé‚®ä»¶è‰ç¨¿ï¼‰

ç”¨æˆ·: ç”Ÿæˆå›¾è¡¨

Alice:
  æ­£åœ¨åˆ›å»ºå›¾è¡¨...
  
  âœ“ å·²ç”Ÿæˆ 3 ä¸ªå›¾è¡¨:
  ğŸ“Š sales-trend.png - é”€å”®è¶‹åŠ¿å›¾
  ğŸ¥§ product-distribution.png - äº§å“å æ¯”é¥¼å›¾
  ğŸ—ºï¸ region-heatmap.png - åŒºåŸŸçƒ­åŠ›å›¾
  
  æ–‡ä»¶ä¿å­˜åœ¨ï¼š~/Documents/Charts/
  
  éœ€è¦æˆ‘æ‰“å¼€æŸ¥çœ‹å—ï¼Ÿ
```

### æ•…äº‹ 3: åˆ›å»ºç¬”è®°ç´¢å¼•

```
ç”¨æˆ·: æˆ‘çš„ Obsidian ç¬”è®°å¤ªä¹±äº†ï¼Œå¸®æˆ‘æ•´ç†ä¸€ä¸‹

Alice:
  æ­£åœ¨åˆ†æä½ çš„ Obsidian åº“...
  
  ğŸ“š åº“æ¦‚è§ˆ:
  â€¢ å…± 234 ç¯‡ç¬”è®°
  â€¢ 12 ä¸ªä¸»è¦æ ‡ç­¾
  â€¢ 156 ä¸ªå†…éƒ¨é“¾æ¥
  â€¢ 23 ç¯‡å­¤ç«‹ç¬”è®°ï¼ˆæ— é“¾æ¥ï¼‰
  
  ğŸ·ï¸ ä¸»è¦è¯é¢˜:
  #é¡¹ç›®ç®¡ç† (45ç¯‡) | #æŠ€æœ¯å­¦ä¹  (32ç¯‡) | #ä¼šè®®çºªè¦ (28ç¯‡)
  
  ğŸ’¡ å»ºè®®:
  1. åˆ›å»º MOCï¼ˆå†…å®¹åœ°å›¾ï¼‰
  2. æ•´ç†å­¤ç«‹ç¬”è®°
  3. æŒ‰æ—¥æœŸå½’æ¡£æ—§ç¬”è®°
  4. ç”Ÿæˆæ ‡ç­¾æ ‘çŠ¶å›¾
  
  æˆ‘å¯ä»¥å¸®ä½ :
  1. è‡ªåŠ¨åˆ›å»ºä¸»é¢˜ MOC
  2. ä¸ºå­¤ç«‹ç¬”è®°å»ºè®®é“¾æ¥
  3. åˆ›å»ºæ¯å‘¨/æ¯æœˆå½’æ¡£

ç”¨æˆ·: åˆ›å»ºä¸»é¢˜ MOC

Alice:
  âœ“ å·²åˆ›å»º 3 ä¸ª MOC:
  
  ğŸ“‚ 00-MOC/
    â”œâ”€â”€ é¡¹ç›®ç®¡ç†-MOC.md (é“¾æ¥ 45 ç¯‡ç¬”è®°)
    â”œâ”€â”€ æŠ€æœ¯å­¦ä¹ -MOC.md (é“¾æ¥ 32 ç¯‡ç¬”è®°)
    â””â”€â”€ ä¼šè®®çºªè¦-MOC.md (é“¾æ¥ 28 ç¯‡ç¬”è®°)
  
  æ¯ä¸ª MOC åŒ…å«ï¼š
  â€¢ æŒ‰æ—¶é—´æ’åºçš„ç¬”è®°åˆ—è¡¨
  â€¢ åŒå‘é“¾æ¥
  â€¢ å¿«é€Ÿè·³è½¬ç›®å½•
  
  å»ºè®®ï¼šå°†è¿™äº› MOC æ·»åŠ åˆ°ä½ çš„é¦–é¡µï¼
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### Week 1: ç•Œé¢åŸå‹
- [x] åŸºç¡€èŠå¤©ç•Œé¢
- [ ] æ¶ˆæ¯æ¸²æŸ“ï¼ˆMarkdownï¼‰
- [ ] Quick Actions äº¤äº’
- [ ] å‘½ä»¤å†å²
- [ ] Banner åŠ¨ç”»

### Week 2: Obsidian é›†æˆ
- [ ] è¿æ¥ Obsidian åº“
- [ ] ç¬”è®°æœç´¢
- [ ] ç¬”è®°åˆ†æ
- [ ] MOC ç”Ÿæˆ
- [ ] æ ‡ç­¾ç®¡ç†

### Week 3: æ–‡æ¡£å¤„ç†
- [ ] Word æ–‡æ¡£è¯»å–
- [ ] Excel æ•°æ®åˆ†æ
- [ ] PDF æå–
- [ ] æ–‡æ¡£æ‘˜è¦
- [ ] æŠ¥å‘Šç”Ÿæˆ

### Week 4: AI èƒ½åŠ›
- [ ] LLM é›†æˆï¼ˆOpenAI/Claudeï¼‰
- [ ] å·¥å…·è°ƒç”¨ï¼ˆFunction Callingï¼‰
- [ ] ä¸Šä¸‹æ–‡ç®¡ç†
- [ ] æµå¼è¾“å‡º
- [ ] å¤šè½®å¯¹è¯

---

## ğŸ’¡ äº§å“å·®å¼‚åŒ–

| ç‰¹æ€§ | ALICE | GitHub Copilot | ChatGPT |
|------|-------|----------------|---------|
| **ç›®æ ‡ç”¨æˆ·** | åŠå…¬èŒå‘˜ | ç¨‹åºå‘˜ | é€šç”¨ç”¨æˆ· |
| **äº¤äº’æ–¹å¼** | CLI | CLI/IDE | Web/App |
| **æ ¸å¿ƒåœºæ™¯** | æ–‡æ¡£+çŸ¥è¯†ç®¡ç† | å†™ä»£ç  | èŠå¤© |
| **æœ¬åœ°èƒ½åŠ›** | æ–‡ä»¶å¤„ç† | ä»£ç åˆ†æ | æ—  |
| **Obsidian** | âœ… æ·±åº¦é›†æˆ | âŒ | âŒ |
| **Office æ–‡æ¡£** | âœ… åŸç”Ÿæ”¯æŒ | âŒ | ğŸŸ¡ éœ€ä¸Šä¼  |
| **ç¦»çº¿åŠŸèƒ½** | ğŸŸ¡ éƒ¨åˆ† | âŒ | âŒ |
| **ä»·æ ¼** | ğŸ’° æ›´ä½ | ğŸ’°ğŸ’° | ğŸ’° |

---

## ğŸ¨ è®¾è®¡åŸåˆ™

> [!important] æ ¸å¿ƒåŸåˆ™
> 1. **å¯¹è¯ä¼˜å…ˆ** - åƒå’ŒåŒäº‹èŠå¤©ä¸€æ ·è‡ªç„¶
> 2. **æ“ä½œé€æ˜** - æ¯ä¸ªåŠ¨ä½œéƒ½æ¸…æ¥šå±•ç¤º
> 3. **çœæ—¶çœåŠ›** - è‡ªåŠ¨åŒ–é‡å¤æ€§å·¥ä½œ
> 4. **å¾ªåºæ¸è¿›** - ä»ç®€å•åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥å­¦ä¹ 
> 5. **éä¾µå…¥å¼** - ä¸æ”¹å˜ç”¨æˆ·ç°æœ‰å·¥ä½œæµ

---

**è®©æˆ‘ä»¬ä»ç•Œé¢å¼€å§‹ï¼Œè¾¹åšè¾¹å®Œå–„ï¼** ğŸš€

ä½ è§‰å¾—è¿™ä¸ªæ–¹å‘æ€ä¹ˆæ ·ï¼Ÿè¦ä¸è¦æˆ‘ç°åœ¨å°±å¸®ä½ æ­å»ºä¸€ä¸ªèƒ½è·‘èµ·æ¥çš„ç•Œé¢åŸå‹ï¼Ÿ
